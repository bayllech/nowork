# CLAUDE.md

This file provides guidance to Claude Code (claude.ai/code) when working with code in this repository.

## é¡¹ç›®æ¦‚è¿°

**NoWork.click** æ˜¯ä¸€ä¸ªæƒ…ç»ªå®£æ³„å¹³å°,è®©æ‰“å·¥äººé€šè¿‡ç‚¹å‡»æŒ‰é’®é‡Šæ”¾å·¥ä½œå‹åŠ›,å¹¶å±•ç¤ºå…¨å›½/å…¨çƒç‚¹å‡»æ’è¡Œæ¦œã€‚

- **æŠ€æœ¯æ ˆ**: Fastify (åç«¯) + Vue 3 (å‰ç«¯,å¾…å¼€å‘) + MySQL + Redis + Docker
- **æ ¸å¿ƒåŠŸèƒ½**: IPå®šä½ã€ç‚¹å‡»ç»Ÿè®¡ã€åœ°åŸŸæ’è¡Œæ¦œã€åæ§½æ–‡æ¡ˆç”Ÿæˆã€å®æ—¶æ•°æ®ç¼“å­˜
- **éƒ¨ç½²æ–¹å¼**: Docker Compose + Cloudflare
- **å½“å‰çŠ¶æ€**: åç«¯åŸºç¡€æ¶æ„å·²å®Œæˆ,TailwindåŸå‹å·²å®Œæˆ,å¾…å¼•å…¥Rediså’Œå¼€å‘Vueå‰ç«¯

## å¸¸ç”¨å‘½ä»¤

### åç«¯å¼€å‘ (backend/)

```bash
# å®‰è£…ä¾èµ– (ä½¿ç”¨ pnpm)
cd backend
pnpm install

# å¼€å‘æ¨¡å¼ (çƒ­é‡è½½)
pnpm run dev

# ç¼–è¯‘ TypeScript
pnpm run build

# ç”Ÿäº§è¿è¡Œ
pnpm run start

# ç±»å‹æ£€æŸ¥
pnpm run lint

# æ•°æ®åº“åˆå§‹åŒ–
pnpm run db:init

# API æ¥å£æµ‹è¯•
pnpm run test:api
```

### Docker ç¯å¢ƒ

```bash
# å¼€å‘ç¯å¢ƒ (å¸¦çƒ­é‡è½½,åŒ…å« MySQL + Redis)
docker compose -f docker/docker-compose.dev.yml up -d

# ç”Ÿäº§ç¯å¢ƒ
docker compose -f docker/docker-compose.prod.yml up -d

# æŸ¥çœ‹æ—¥å¿—
docker compose -f docker/docker-compose.dev.yml logs -f backend
docker compose -f docker/docker-compose.dev.yml logs -f redis

# è¿æ¥ Redis CLI
docker exec -it nowork-redis-dev redis-cli

# åœæ­¢å¹¶æ¸…ç†
docker compose -f docker/docker-compose.dev.yml down -v
```

### å‰ç«¯å¼€å‘

```bash
# å½“å‰é˜¶æ®µ: Tailwind CSS åŸå‹ (prototype/tailwind/)
# æŸ¥çœ‹åŸå‹: ç›´æ¥åœ¨æµè§ˆå™¨æ‰“å¼€ prototype/tailwind/*.html

# Vue 3 å‰ç«¯ (è®¡åˆ’åœ¨ frontend/ ç›®å½•)
cd frontend
pnpm install
pnpm run dev      # å¼€å‘æœåŠ¡å™¨
pnpm run build    # ç”Ÿäº§æ„å»º
pnpm run preview  # é¢„è§ˆæ„å»ºç»“æœ
```

### æ•°æ®åº“æ“ä½œ

```bash
# è¿æ¥åˆ° Docker ä¸­çš„ MySQL (å¼€å‘ç¯å¢ƒ)
docker exec -it nowork-mysql-dev mysql -u nowork -p
# å¯†ç : nowork (è§ .env.dev)

# æ‰§è¡Œ SQL æ–‡ä»¶
docker exec -i nowork-mysql-dev mysql -u nowork -pnowork nowork < backend/sql/schema.sql
```

## æ¶æ„è®¾è®¡

### åç«¯æ¶æ„ (backend/)

```
backend/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ main.ts              # åº”ç”¨å…¥å£
â”‚   â”œâ”€â”€ app.ts               # Fastify åº”ç”¨æ„å»º
â”‚   â”œâ”€â”€ config/
â”‚   â”‚   â””â”€â”€ env.ts           # ç¯å¢ƒå˜é‡é…ç½® (ä½¿ç”¨ zod æ ¡éªŒ)
â”‚   â”œâ”€â”€ plugins/
â”‚   â”‚   â”œâ”€â”€ mysql.ts         # MySQL è¿æ¥æ± æ’ä»¶ (@fastify/mysql)
â”‚   â”‚   â””â”€â”€ rate-limit.ts    # é™æµæ’ä»¶ (@fastify/rate-limit)
â”‚   â”œâ”€â”€ routes/              # è·¯ç”±å®šä¹‰
â”‚   â”‚   â”œâ”€â”€ index.ts         # è·¯ç”±æ³¨å†Œå…¥å£
â”‚   â”‚   â”œâ”€â”€ hit.route.ts     # POST /api/hit (ç‚¹å‡»è®°å½•)
â”‚   â”‚   â”œâ”€â”€ stats.route.ts   # GET /api/stats/* (ç»Ÿè®¡æŸ¥è¯¢)
â”‚   â”‚   â””â”€â”€ phrases.route.ts # GET /api/phrases (æ–‡æ¡ˆæŸ¥è¯¢)
â”‚   â”œâ”€â”€ schemas/             # Zod æ•°æ®æ ¡éªŒ schema
â”‚   â”œâ”€â”€ services/            # ä¸šåŠ¡é€»è¾‘å±‚
â”‚   â”‚   â”œâ”€â”€ ip-location.service.ts  # IPå®šä½ (ip2region)
â”‚   â”‚   â”œâ”€â”€ ip-cache.service.ts     # IPç¼“å­˜æŸ¥è¯¢/å†™å…¥
â”‚   â”‚   â”œâ”€â”€ phrase.service.ts       # æ–‡æ¡ˆæŠ½å–
â”‚   â”‚   â””â”€â”€ stat.service.ts         # ç»Ÿè®¡æ•°æ®èšåˆ
â”‚   â”œâ”€â”€ types/
â”‚   â”‚   â””â”€â”€ fastify.d.ts     # Fastify ç±»å‹æ‰©å±•
â”‚   â””â”€â”€ utils/
â”‚       â”œâ”€â”€ logger.ts        # Pino æ—¥å¿—å°è£…
â”‚       â””â”€â”€ ip.ts            # IP æå–å·¥å…·
â”œâ”€â”€ scripts/
â”‚   â”œâ”€â”€ db-init.ts           # æ•°æ®åº“åˆå§‹åŒ–è„šæœ¬
â”‚   â””â”€â”€ test-api.ts          # API æµ‹è¯•è„šæœ¬
â””â”€â”€ sql/
    â”œâ”€â”€ schema.sql           # æ•°æ®åº“è¡¨ç»“æ„
    â””â”€â”€ seed_phrases.sql     # åˆå§‹æ–‡æ¡ˆæ•°æ®
```

### å…³é”®è®¾è®¡æ¨¡å¼

1. **æ’ä»¶åŒ–æ¶æ„**: Fastify æ’ä»¶ç³»ç»Ÿ,æ‰€æœ‰åŠŸèƒ½æ¨¡å—åŒ–æ³¨å†Œ
2. **æœåŠ¡å±‚åˆ†ç¦»**: routes â†’ schemas â†’ services,èŒè´£æ¸…æ™°
3. **ç¯å¢ƒé…ç½®**: ä½¿ç”¨ zod è¿›è¡Œç¯å¢ƒå˜é‡æ ¡éªŒ,ç±»å‹å®‰å…¨
4. **è¿æ¥æ± ç®¡ç†**: @fastify/mysql ç®¡ç†æ•°æ®åº“è¿æ¥å¤ç”¨
5. **é™æµä¿æŠ¤**: @fastify/rate-limit é˜²æ­¢ API æ»¥ç”¨
6. **ç¼“å­˜ä¼˜å…ˆ**: Redis æ‰¿æ‹…å®æ—¶æ•°æ®ç´¯åŠ å’Œæ’è¡Œæ¦œå®æ—¶æ’åº,MySQL ä½œä¸ºæŒä¹…åŒ–å­˜å‚¨
7. **å¼‚æ­¥è½åº“**: Worker å®šæ—¶å°† Redis å¢é‡æ•°æ®æ‰¹é‡å†™å…¥ MySQL

### æ•°æ®åº“è®¾è®¡

```sql
-- IP åœ°ç†ä¿¡æ¯ç¼“å­˜ (é¿å…é‡å¤æŸ¥è¯¢)
hit_ip_cache (ip, country, province, city, last_update)

-- ç´¯è®¡ç»Ÿè®¡ (æ€»æ’è¡Œæ¦œ)
stat_total_region (country, province, city, page, count)
  PRIMARY KEY: (country, province, city, page)

-- æ¯æ—¥ç»Ÿè®¡ (æ—¥æ’è¡Œæ¦œ)
stat_daily_region (stat_date, country, province, city, page, count)
  PRIMARY KEY: (stat_date, country, province, city, page)
  INDEX: idx_daily_page (stat_date, page, count)

-- åæ§½æ–‡æ¡ˆæ± 
phrases (id, page, content, weight, created_at)
  INDEX: idx_phrase_page (page)
```

**èšåˆç­–ç•¥**:
- **å†™å…¥æµç¨‹**: ç‚¹å‡»è¯·æ±‚ â†’ Redis è‡ªå¢è®¡æ•° â†’ Worker æ‰¹é‡è½åº“ MySQL
- **æŸ¥è¯¢æµç¨‹**: ä¼˜å…ˆä» Redis è¯»å–å®æ—¶æ•°æ®,æœªå‘½ä¸­åˆ™æŸ¥è¯¢ MySQL
- **æ•°æ®ä¸€è‡´æ€§**: Worker ä½¿ç”¨ `INSERT ... ON DUPLICATE KEY UPDATE` ä¿è¯å¹‚ç­‰æ€§

### API æ ¸å¿ƒæ¥å£

```
POST /api/hit
  å‚æ•°: { page?: string }
  åŠŸèƒ½: è®°å½•ç‚¹å‡» â†’ IPå®šä½ â†’ æ›´æ–°ç»Ÿè®¡ â†’ è¿”å›æ’è¡Œæ•°æ® + éšæœºæ–‡æ¡ˆ

GET /api/stats/china?type=daily&date=2025-10-20&page=default
  åŠŸèƒ½: æŸ¥è¯¢å›½å†…åœ°åŸŸæ’è¡Œæ¦œ

GET /api/stats/global?type=total&page=default
  åŠŸèƒ½: æŸ¥è¯¢æµ·å¤–å›½å®¶æ’è¡Œæ¦œ

GET /api/phrases/:page
  åŠŸèƒ½: è·å–æŒ‡å®šé¡µé¢çš„éšæœºæ–‡æ¡ˆ
```

### IP å®šä½æµç¨‹

1. ä»è¯·æ±‚å¤´æå–çœŸå® IP (`X-Real-IP` / `X-Forwarded-For`)
2. æŸ¥è¯¢ `hit_ip_cache` è¡¨ç¼“å­˜
3. ç¼“å­˜æœªå‘½ä¸­ â†’ ä½¿ç”¨ ip2region æœ¬åœ°åº“è§£æ (xdb æ–‡ä»¶)
4. è§£æå¤±è´¥ â†’ å›é€€åˆ° ip-api.com (å¾…å®ç°)
5. ç»“æœå†™å…¥ç¼“å­˜è¡¨ + è¿”å›åœ°ç†ä¿¡æ¯

## ç¯å¢ƒå˜é‡

é¡¹ç›®ä½¿ç”¨ä¸‰ä¸ªç¯å¢ƒæ–‡ä»¶:

- `.env.example` - æ¨¡æ¿æ–‡ä»¶
- `.env.dev` - å¼€å‘ç¯å¢ƒé…ç½®
- `.env.prod` - ç”Ÿäº§ç¯å¢ƒé…ç½®

**å…³é”®é…ç½®é¡¹**:
```env
NODE_ENV=development|production
PORT=3000
MYSQL_HOST=mysql  # Docker ç¯å¢ƒä½¿ç”¨æœåŠ¡å
MYSQL_PORT=3306
MYSQL_DATABASE=nowork
MYSQL_USER=nowork
MYSQL_PASSWORD=***
REDIS_HOST=redis  # Docker ç¯å¢ƒä½¿ç”¨æœåŠ¡å
REDIS_PORT=6379
REDIS_PASSWORD=***  # ç”Ÿäº§ç¯å¢ƒå¿…é¡»è®¾ç½®
REDIS_DB=0
RATE_LIMIT_PER_MINUTE=60
IP2REGION_PATH=/app/ip2region.xdb  # ip2region æ•°æ®åº“è·¯å¾„
DEFAULT_PAGE=default
LOG_LEVEL=info
WORKER_ENABLED=true  # æ˜¯å¦å¯ç”¨ Worker
WORKER_BATCH_SIZE=500  # æ‰¹é‡è½åº“æ•°é‡
WORKER_FLUSH_INTERVAL_MS=3000  # è½åº“é—´éš”(æ¯«ç§’)
```

## å‰ç«¯åŸå‹ (prototype/)

å½“å‰é˜¶æ®µä¸º HTML/CSS/JavaScript åŸå‹,ç”¨äºæ¼”ç¤ºäº¤äº’é€»è¾‘:

- **01-homepage.html**: ä¸»é¡µ (æƒ…ç»ªæŒ‰é’® + æ€’æ°”åŠ¨ç”» + ç»Ÿè®¡æ•°æ®)
- **02-ranking.html**: æ’è¡Œæ¦œ (åœ°å›¾çƒ­åŠ›å›¾ + åŸå¸‚æ¦œå• + æµ·å¤–æ¦œå•)
- **03-roles.html**: è§’è‰²é¡µ (6ç§è§’è‰²åœºæ™¯å¡ç‰‡)
- **tailwind/**: Tailwind CSS ç‰ˆæœ¬åŸå‹

**å®é™…å‰ç«¯å¼€å‘**: è®¡åˆ’ä½¿ç”¨ Vue 3 + Vite + TypeScript + Pinia,ä½†å°šæœªåˆå§‹åŒ–

## é‡è¦æ³¨æ„äº‹é¡¹

1. **åŒ…ç®¡ç†å™¨**: åç«¯å¿…é¡»ä½¿ç”¨ `pnpm`,å·²åœ¨ package.json ä¸­æŒ‡å®š `packageManager`
2. **æ•°æ®åº“åˆå§‹åŒ–**: é¦–æ¬¡è¿è¡Œå‰å¿…é¡»æ‰§è¡Œ `pnpm run db:init` åˆ›å»ºè¡¨ç»“æ„å’Œç§å­æ•°æ®
3. **ip2region æ•°æ®**: éœ€è¦ä¸‹è½½ ip2region.xdb æ–‡ä»¶å¹¶æ”¾åˆ° `data/` ç›®å½•,Docker ä¼šæŒ‚è½½åˆ°å®¹å™¨å†…
4. **TypeScript ç¼–è¯‘**: ç”Ÿäº§éƒ¨ç½²å‰å¿…é¡»è¿è¡Œ `pnpm run build`,dist/ ç›®å½•åŒ…å«ç¼–è¯‘åä»£ç 
5. **ç«¯å£å†²çª**: å¼€å‘ç¯å¢ƒåç«¯ç›‘å¬ 3000,MySQL ç›‘å¬ 3306,ç¡®ä¿ç«¯å£æœªè¢«å ç”¨
6. **çƒ­é‡è½½**: å¼€å‘æ¨¡å¼ä½¿ç”¨ `tsx watch`,ä¿®æ”¹ä»£ç åè‡ªåŠ¨é‡å¯

## å¼€å‘å·¥ä½œæµ

### é¦–æ¬¡å¯åŠ¨é¡¹ç›®

```bash
# 1. å¯åŠ¨ Docker ç¯å¢ƒ (åŒ…å« MySQL)
docker compose -f docker/docker-compose.dev.yml up -d

# 2. ç­‰å¾… MySQL å¥åº·æ£€æŸ¥é€šè¿‡ (çº¦ 10-30 ç§’)
docker compose -f docker/docker-compose.dev.yml logs mysql

# 3. åˆå§‹åŒ–æ•°æ®åº“ (ä»…é¦–æ¬¡éœ€è¦)
cd backend
pnpm run db:init

# 4. åç«¯æœåŠ¡ä¼šè‡ªåŠ¨å¯åŠ¨ (Docker compose é…ç½®äº† command)
# æŸ¥çœ‹åç«¯æ—¥å¿—
docker compose -f docker/docker-compose.dev.yml logs -f backend
```

### æ—¥å¸¸å¼€å‘

```bash
# æœ¬åœ°å¼€å‘ (ä¸ä½¿ç”¨ Docker)
cd backend
pnpm install
pnpm run dev

# æˆ–ä½¿ç”¨ Docker (æ¨è,ç¯å¢ƒä¸€è‡´)
docker compose -f docker/docker-compose.dev.yml up -d
```

### æµ‹è¯• API

```bash
# ä½¿ç”¨å†…ç½®æµ‹è¯•è„šæœ¬
cd backend
pnpm run test:api

# æˆ–æ‰‹åŠ¨æµ‹è¯•
curl -X POST http://localhost:3000/api/hit -H "Content-Type: application/json" -d '{"page":"default"}'
curl http://localhost:3000/api/stats/china?type=daily
curl http://localhost:3000/api/phrases/default
```

## Git åˆ†æ”¯ç­–ç•¥

- **main**: ç”Ÿäº§åˆ†æ”¯,å·²å®Œæˆåç«¯åˆå§‹åŒ–å’ŒåŸå‹è®¾è®¡
- æäº¤ä¿¡æ¯é£æ ¼: `feat:`, `fix:`, `docs:`, `refactor:` ç­‰çº¦å®šå¼æäº¤

## Redis æ¶æ„è®¾è®¡

### Redis é”®ç©ºé—´è®¾è®¡

```
# ç‚¹å‡»ç´¯ç§¯è®¡æ•° (Hash)
hit:agg:{page}:{role}:{date}  # å­—æ®µ: province/country -> count
ä¾‹: hit:agg:default:default:2025-10-21
    HINCRBY æ“ä½œç´¯åŠ ç‚¹å‡»æ•°

# å®æ—¶æ’è¡Œæ¦œ (Sorted Set)
ranking:cn:{period}  # å›½å†…æ¦œ, score=count, member=province
ranking:global:{period}  # æµ·å¤–æ¦œ, score=count, member=country
ä¾‹: ranking:cn:daily
    ZINCRBY æ“ä½œç´¯åŠ åˆ†æ•°

# IP åœ°ç†ä¿¡æ¯ç¼“å­˜ (String)
ip:geo:{ip}  # å€¼: JSON æ ¼å¼çš„åœ°ç†ä¿¡æ¯
TTL: 7å¤©

# çƒ­é—¨æ–‡æ¡ˆç¼“å­˜ (List)
phrase:hot:{page}  # å­˜å‚¨æ–‡æ¡ˆIDåˆ—è¡¨
TTL: 24å°æ—¶

# Worker è½åº“é” (String)
hit:lock:{timestamp}  # é˜²æ­¢é‡å¤è½åº“
TTL: ç•¥å¤§äºæ‰¹å¤„ç†çª—å£
```

### æ•°æ®æµè®¾è®¡

```
ç”¨æˆ·ç‚¹å‡» â†’ POST /api/hit
  â†“
1. Redis HINCRBY (ç´¯åŠ ç‚¹å‡»æ•°)
2. Redis ZINCRBY (æ›´æ–°æ’è¡Œæ¦œ)
3. è¿”å›å®æ—¶æ•°æ®ç»™å‰ç«¯
  â†“
Worker å®šæ—¶ä»»åŠ¡ (æ¯3ç§’)
  â†“
1. è¯»å– Redis å¢é‡æ•°æ®
2. æ‰¹é‡å†™å…¥ MySQL
3. æ¸…ç†å·²è½åº“çš„ Redis é”®
```

### Redis æ€§èƒ½ä¼˜åŒ–

- **Pipeline**: æ‰¹é‡æ“ä½œä½¿ç”¨ Pipeline å‡å°‘ç½‘ç»œå¾€è¿”
- **TTL ç­–ç•¥**:
  - ç‚¹å‡»ç´¯ç§¯æ•°æ®: å½“æ—¥æ•°æ®ä¸è¿‡æœŸ,æ¬¡æ—¥å‡Œæ™¨æ¸…ç†
  - æ’è¡Œæ¦œç¼“å­˜: 30-60ç§’ TTL,å¹³è¡¡å®æ—¶æ€§å’Œæ€§èƒ½
  - IPç¼“å­˜: 7å¤© TTL
- **æŒä¹…åŒ–**: å¼€å‘ç¯å¢ƒ RDB,ç”Ÿäº§ç¯å¢ƒ AOF + RDB æ··åˆæŒä¹…åŒ–

## å¼€å‘è·¯çº¿å›¾

### Sprint 1: Redis é›†æˆä¸åç«¯ä¼˜åŒ– (å½“å‰é˜¶æ®µ)

**ç›®æ ‡**: å°† Redis å¼•å…¥ç°æœ‰åç«¯,å®ç°é«˜æ€§èƒ½ç‚¹å‡»ç»Ÿè®¡å’Œæ•°æ®ç¼“å­˜

**æ—¶é—´**: 2-3 å¤©

**çŠ¶æ€**: ğŸ”„ è¿›è¡Œä¸­

#### ä»»åŠ¡æ¸…å•

**1.1 Redis åŸºç¡€é›†æˆ** âœ… (éƒ¨åˆ†å®Œæˆ)
- [x] Docker Compose æ·»åŠ  Redis æœåŠ¡ (å·²å®Œæˆ)
- [ ] å®‰è£…ä¾èµ–: `@fastify/redis`, `ioredis`
- [ ] åˆ›å»º Redis æ’ä»¶ `backend/src/plugins/redis.ts`
- [ ] åœ¨ app.ts ä¸­æ³¨å†Œ Redis æ’ä»¶
- [ ] æ·»åŠ  Redis ç±»å‹å®šä¹‰åˆ° `types/fastify.d.ts`
- [ ] é…ç½®ç¯å¢ƒå˜é‡æ ¡éªŒ (env.ts)

**1.2 Redis æœåŠ¡å±‚è®¾è®¡**
- [ ] åˆ›å»º `services/redis-cache.service.ts` (ç»Ÿä¸€ç¼“å­˜æ“ä½œ)
- [ ] åˆ›å»º `services/redis-ranking.service.ts` (æ’è¡Œæ¦œæ“ä½œ)
- [ ] åˆ›å»º `services/redis-stats.service.ts` (ç»Ÿè®¡æ•°æ®æ“ä½œ)
- [ ] å®ç° Pipeline æ‰¹é‡æ“ä½œå·¥å…·å‡½æ•°
- [ ] æ·»åŠ ç¼“å­˜é”®å‘½åå¸¸é‡ `utils/redis-keys.ts`

**1.3 ç‚¹å‡»æ¥å£ Redis åŒ–æ”¹é€ **
- [ ] æ”¹é€  IP ç¼“å­˜é€»è¾‘ä½¿ç”¨ Redis (`ip:geo:{ip}`)
- [ ] å®ç°ç‚¹å‡»è®¡æ•° Redis ç´¯åŠ  (`hit:agg:{page}:{role}:{date}`)
- [ ] å®ç°æ’è¡Œæ¦œå®æ—¶æ›´æ–° (`ranking:cn:daily`, `ranking:global:daily`)
- [ ] ä¼˜åŒ– /api/hit æ¥å£è¿”å›å®æ—¶ Redis æ•°æ®
- [ ] æ·»åŠ é™çº§é€»è¾‘ (Redis æ•…éšœæ—¶å›é€€åˆ° MySQL)

**1.4 ç»Ÿè®¡æ¥å£ä¼˜åŒ–**
- [ ] æ”¹é€  /api/stats/china ä¼˜å…ˆè¯» Redis
- [ ] æ”¹é€  /api/stats/global ä¼˜å…ˆè¯» Redis
- [ ] å®ç°ç¼“å­˜é¢„çƒ­é€»è¾‘ (MySQL â†’ Redis)
- [ ] æ·»åŠ ç¼“å­˜ TTL ç­–ç•¥ (30-60ç§’)
- [ ] å®ç°ç¼“å­˜å‡»ç©¿ä¿æŠ¤ (äº’æ–¥é”)

**1.5 Worker æ‰¹é‡è½åº“æœºåˆ¶**
- [ ] åˆ›å»º `workers/` ç›®å½•å’Œ Worker åŸºç¡€æ¶æ„
- [ ] å®ç° `workers/hit-aggregator.ts` (ç‚¹å‡»æ•°æ®è½åº“)
- [ ] å®ç°æ‰¹é‡è¯»å– Redis å¢é‡æ•°æ®
- [ ] å®ç°æ‰¹é‡å†™å…¥ MySQL (INSERT ON DUPLICATE KEY UPDATE)
- [ ] æ·»åŠ è½åº“é”æœºåˆ¶ (`hit:lock:{timestamp}`)
- [ ] å®ç°å¤±è´¥é‡è¯•å’Œè¡¥å¿é˜Ÿåˆ—
- [ ] æ·»åŠ  Worker å¯åŠ¨å¼€å…³ (WORKER_ENABLED)

**1.6 ç›‘æ§ä¸æµ‹è¯•**
- [ ] æ·»åŠ  Redis è¿æ¥å¥åº·æ£€æŸ¥
- [ ] å®ç° Redis æ€§èƒ½ç›‘æ§æ—¥å¿—
- [ ] æ›´æ–° API æµ‹è¯•è„šæœ¬éªŒè¯ Redis åŠŸèƒ½
- [ ] ç¼–å†™ Redis é”®ç©ºé—´æ–‡æ¡£
- [ ] å‹åŠ›æµ‹è¯• (/api/hit æ¥å£ 100 QPS+)

#### éªŒæ”¶æ ‡å‡†
- âœ… Redis æ­£å¸¸è¿æ¥å¹¶å¯é€šè¿‡ CLI æŸ¥è¯¢æ•°æ®
- âœ… /api/hit æ¥å£å“åº”æ—¶é—´ < 50ms (Redis æ¨¡å¼)
- âœ… Worker æ¯3ç§’æˆåŠŸè½åº“,æ— æ•°æ®ä¸¢å¤±
- âœ… æ’è¡Œæ¦œæ•°æ®å®æ—¶æ›´æ–° (< 5ç§’å»¶è¿Ÿ)
- âœ… Redis æ•…éšœæ—¶è‡ªåŠ¨é™çº§åˆ° MySQL

### Sprint 2: Vue 3 å‰ç«¯åˆå§‹åŒ–ä¸åŸºç¡€æ¶æ„

**ç›®æ ‡**: æ­å»º Vue 3 å‰ç«¯é¡¹ç›®,å®ŒæˆåŸºç¡€æ¶æ„å’Œé€šç”¨ç»„ä»¶

**æ—¶é—´**: 3-4 å¤©

**çŠ¶æ€**: â³ å¾…å¼€å§‹

**ä¾èµ–**: Sprint 1 å®Œæˆåå¼€å§‹

#### ä»»åŠ¡æ¸…å•

**2.1 é¡¹ç›®åˆå§‹åŒ–**
- [ ] ä½¿ç”¨ Vite åˆ›å»º Vue 3 + TypeScript é¡¹ç›® (`pnpm create vite frontend`)
- [ ] é…ç½® `tsconfig.json` å’Œè·¯å¾„åˆ«å (@/)
- [ ] å®‰è£…æ ¸å¿ƒä¾èµ–: `vue-router`, `pinia`, `axios`, `vueuse`
- [ ] å®‰è£… UI ä¾èµ–: `@headlessui/vue`, `@heroicons/vue`
- [ ] é…ç½® `package.json` è„šæœ¬å’Œ `packageManager`

**2.2 Tailwind CSS é›†æˆ**
- [ ] å®‰è£… Tailwind CSS å’Œ PostCSS æ’ä»¶
- [ ] å¤åˆ¶åŸå‹çš„ `tailwind.config.js` é…ç½®
- [ ] é…ç½®è‡ªå®šä¹‰é¢œè‰²ã€å­—ä½“ã€é˜´å½±
- [ ] åˆ›å»º `styles/base.css` å¹¶å¼•å…¥ Tailwind æŒ‡ä»¤
- [ ] é…ç½® FontAwesome å›¾æ ‡ç³»ç»Ÿ

**2.3 è·¯ç”±é…ç½®**
- [ ] åˆ›å»º `router/index.ts` é…ç½®æ–‡ä»¶
- [ ] å®šä¹‰äº”ä¸ªæ ¸å¿ƒè·¯ç”±: `/`, `/ranking-cn`, `/ranking-global`, `/roles`, `/share`
- [ ] é…ç½®è·¯ç”±æ‡’åŠ è½½å’Œé¡µé¢æ ‡é¢˜
- [ ] å®ç°è·¯ç”±å®ˆå«å’Œé¡µé¢åˆ‡æ¢åŠ¨ç”»
- [ ] æ·»åŠ  404 é¡µé¢

**2.4 çŠ¶æ€ç®¡ç† (Pinia)**
- [ ] åˆ›å»º `stores/` ç›®å½•ç»“æ„
- [ ] å®ç° `useStatsStore` (å›½å†…æ¦œ/æµ·å¤–æ¦œæ•°æ®)
- [ ] å®ç° `useRolesStore` (è§’è‰²æ•°æ®)
- [ ] å®ç° `usePhraseStore` (åæ§½æ–‡æ¡ˆæ•°æ®)
- [ ] å®ç° `useUIStore` (UI çŠ¶æ€: åŠ è½½ã€é”™è¯¯æç¤ºç­‰)
- [ ] é…ç½® Pinia æŒä¹…åŒ–æ’ä»¶ (å¯é€‰)

**2.5 TypeScript ç±»å‹å®šä¹‰**
- [ ] åˆ›å»º `types/` ç›®å½•
- [ ] å®šä¹‰ API å“åº”ç±»å‹ (`types/api.ts`)
- [ ] å®šä¹‰æ•°æ®æ¨¡å‹ç±»å‹ (`types/models.ts`): Region, Role, Phrase, Stats
- [ ] å®šä¹‰ç»„ä»¶ Props ç±»å‹ (`types/components.ts`)
- [ ] ä» `mock-data.js` æå–ç±»å‹å®šä¹‰

**2.6 API è¯·æ±‚å±‚å°è£…**
- [ ] åˆ›å»º `api/` ç›®å½•
- [ ] é…ç½® Axios å®ä¾‹ (`api/request.ts`): æ‹¦æˆªå™¨ã€è¶…æ—¶ã€é”™è¯¯å¤„ç†
- [ ] å®ç° `api/hit.ts` (ç‚¹å‡»æ¥å£)
- [ ] å®ç° `api/stats.ts` (ç»Ÿè®¡æ¥å£)
- [ ] å®ç° `api/phrases.ts` (æ–‡æ¡ˆæ¥å£)
- [ ] æ·»åŠ è¯·æ±‚å–æ¶ˆå’Œé˜²æŠ–é€»è¾‘

**2.7 é€šç”¨ç»„ä»¶å¼€å‘**
- [ ] `NavigationBar.vue` (é¡¶éƒ¨å¯¼èˆª,è·¯ç”±é«˜äº®)
- [ ] `Footer.vue` (é¡µè„š)
- [ ] `LoadingSpinner.vue` (åŠ è½½åŠ¨ç”»)
- [ ] `ErrorMessage.vue` (é”™è¯¯æç¤º)
- [ ] `BaseButton.vue` (æŒ‰é’®åŸºç¡€ç»„ä»¶)
- [ ] `BaseCard.vue` (å¡ç‰‡åŸºç¡€ç»„ä»¶)

**2.8 ç¯å¢ƒé…ç½®ä¸å·¥å…·**
- [ ] åˆ›å»º `.env.development` å’Œ `.env.production`
- [ ] é…ç½® API åŸºç¡€è·¯å¾„ (`VITE_API_BASE_URL`)
- [ ] é…ç½® ESLint å’Œ Prettier
- [ ] æ·»åŠ  Git hooks (husky + lint-staged)
- [ ] é…ç½®æ„å»ºä¼˜åŒ–å’Œä»£ç åˆ†å‰²

#### éªŒæ”¶æ ‡å‡†
- âœ… å¼€å‘æœåŠ¡å™¨æ­£å¸¸è¿è¡Œ (`pnpm run dev`)
- âœ… è·¯ç”±å¯¼èˆªæ­£å¸¸,é¡µé¢åˆ‡æ¢æµç•…
- âœ… Pinia çŠ¶æ€ç®¡ç†å·¥ä½œæ­£å¸¸
- âœ… API è¯·æ±‚å¯æ­£ç¡®è°ƒç”¨åç«¯æ¥å£
- âœ… é€šç”¨ç»„ä»¶å¯å¤ç”¨ä¸”æ ·å¼æ­£ç¡®

---

### Sprint 3: æ ¸å¿ƒé¡µé¢å¼€å‘ - é¦–é¡µä¸æ¦œå•

**ç›®æ ‡**: å®ç°é¦–é¡µã€å›½å†…æ¦œã€æµ·å¤–æ¦œä¸‰ï¿½ï¿½æ ¸å¿ƒé¡µé¢

**æ—¶é—´**: 5-6 å¤©

**çŠ¶æ€**: â³ å¾…å¼€å§‹

**ä¾èµ–**: Sprint 2 å®Œæˆåå¼€å§‹

#### ä»»åŠ¡æ¸…å•

**3.1 é¦–é¡µå¼€å‘ (Home.vue)**

*3.1.1 æ€’æ°”æŒ‰é’®ç»„ä»¶*
- [ ] åˆ›å»º `RageButton.vue` ç»„ä»¶
- [ ] å®ç°å¤šæ¡£ä½æ¸å˜åŠ¨ç”» (æ ¹æ®ç‚¹å‡»æ¬¡æ•°)
- [ ] é›†æˆéŸ³æ•ˆç³»ç»Ÿ (ä¸åŒç­‰çº§ä¸åŒéŸ³æ•ˆ)
- [ ] å®ç°ç‚¹å‡»åé¦ˆåŠ¨ç”» (æ¶Ÿæ¼ªæ•ˆæœ)
- [ ] å¯¹æ¥ `/api/hit` æ¥å£
- [ ] å®ç°èŠ‚æµé˜²æŠ– (é¿å…æ¶æ„åˆ·é‡)

*3.1.2 ç»Ÿè®¡å¡ç‰‡ç»„ä»¶*
- [ ] åˆ›å»º `StatCard.vue` (å±•ç¤ºä»Šæ—¥/æ€»è®¡æ•°æ®)
- [ ] å®ç°æ•°å­—æ»šåŠ¨åŠ¨ç”» (CountUp.js)
- [ ] æ˜¾ç¤ºæ€’æ°”ç­‰çº§å’Œè¶‹åŠ¿
- [ ] å®æ—¶æ›´æ–°ç»Ÿè®¡æ•°æ®
- [ ] å“åº”å¼å¸ƒå±€é€‚é…

*3.1.3 æ¦œå•é¢„è§ˆç»„ä»¶*
- [ ] åˆ›å»º `RankingPreview.vue` (åŒåˆ—æ¦œå•)
- [ ] æ”¯æŒå›½å†…/æµ·å¤–åˆ‡æ¢
- [ ] æ˜¾ç¤º Top 10 åŸå¸‚/å›½å®¶
- [ ] æ·»åŠ "æŸ¥çœ‹å®Œæ•´æ¦œå•"é“¾æ¥
- [ ] å®ç°æ•°æ®è‡ªåŠ¨åˆ·æ–°

*3.1.4 æ´»åŠ¨å¡ç‰‡ä¸åˆ†äº«å¼•å¯¼*
- [ ] åˆ›å»ºæ´»åŠ¨å¡ç‰‡ç»„ä»¶
- [ ] æ·»åŠ "åˆ†äº«æ€’æ°”"CTA æŒ‰é’®
- [ ] è·³è½¬åˆ°åæ§½å¡é¡µé¢

**3.2 å›½å†…æ¦œå¼€å‘ (RankingChina.vue)**

*3.2.1 åœ°å›¾é›†æˆ*
- [ ] å®‰è£… ECharts å’Œ Vue-ECharts
- [ ] é›†æˆä¸­å›½åœ°å›¾ (china.json)
- [ ] å®ç°çƒ­åŠ›å›¾æ•°æ®å¯è§†åŒ–
- [ ] åœ°å›¾äº¤äº’: ç‚¹å‡»çœä»½é«˜äº®
- [ ] åœ°å›¾è‡ªé€‚åº”å®¹å™¨å¤§å°

*3.2.2 æ¦œå•åˆ—è¡¨ç»„ä»¶*
- [ ] åˆ›å»º `CityRankingList.vue`
- [ ] æ˜¾ç¤ºåŸå¸‚åç§°ã€æ€’æ°”ç­‰çº§ã€ç‚¹å‡»æ•°
- [ ] æ·»åŠ æ€’æ°”ç­‰çº§å¾½æ ‡å’Œé¢œè‰²
- [ ] æ˜¾ç¤ºè¶‹åŠ¿ç™¾åˆ†æ¯” (ä¸Šå‡/ä¸‹é™)
- [ ] æ”¯æŒåˆ†é¡µæˆ–è™šæ‹Ÿæ»šåŠ¨

*3.2.3 æ—¥æ¦œ/æ€»æ¦œåˆ‡æ¢*
- [ ] å®ç° Tab åˆ‡æ¢ç»„ä»¶
- [ ] å¯¹æ¥ `/api/stats/china?type=daily|total`
- [ ] åˆ‡æ¢æ—¶æ›´æ–°åœ°å›¾å’Œæ¦œå•
- [ ] URL æŸ¥è¯¢å‚æ•°åŒæ­¥ (date, type)

*3.2.4 æ€’æ°”æé†’å¡ç‰‡*
- [ ] ï¿½ï¿½å»ºæé†’å¡ç‰‡ç»„ä»¶
- [ ] æ˜¾ç¤ºçƒ­ç‚¹åŸå¸‚äº‹ä»¶
- [ ] åŠ¨æ€åŠ è½½æé†’å†…å®¹

**3.3 æµ·å¤–æ¦œå¼€å‘ (RankingGlobal.vue)**

*3.3.1 ä¸–ç•Œåœ°å›¾é›†æˆ*
- [ ] é›†æˆä¸–ç•Œåœ°å›¾ (world.json)
- [ ] å®ç°çƒ­åŠ›å›¾å¯è§†åŒ–
- [ ] åœ°å›¾äº¤äº’å’Œé«˜äº®

*3.3.2 å›½å®¶æ¦œå•åˆ—è¡¨*
- [ ] åˆ›å»º `CountryRankingList.vue`
- [ ] æ˜¾ç¤ºå›½å®¶åç§°ã€æ€’æ°”ç­‰çº§ã€ç‚¹å‡»æ•°
- [ ] å¯¹æ¥ `/api/stats/global` æ¥å£
- [ ] æ”¯æŒæ—¥æ¦œ/æ€»æ¦œåˆ‡æ¢

*3.3.3 é¡µé¢ä¼˜åŒ–*
- [ ] ç§»é™¤å†—ä½™æ¨¡å— (ç²¾ç®€è®¾è®¡)
- [ ] ä¿æŒä¸å›½å†…æ¦œä¸€è‡´çš„å¸ƒå±€é£æ ¼
- [ ] å“åº”å¼é€‚é…

#### éªŒæ”¶æ ‡å‡†
- âœ… é¦–é¡µæ€’æ°”æŒ‰é’®å¯æ­£å¸¸ç‚¹å‡»å¹¶æ›´æ–°æ•°æ®
- âœ… éŸ³æ•ˆç³»ç»Ÿæ­£å¸¸å·¥ä½œ
- âœ… ECharts åœ°å›¾æ­£å¸¸æ˜¾ç¤ºä¸”æ•°æ®æ­£ç¡®
- âœ… æ¦œå•æ•°æ®å®æ—¶æ›´æ–°
- âœ… æ—¥æ¦œ/æ€»æ¦œåˆ‡æ¢æµç•…
- âœ… ç§»åŠ¨ç«¯æ˜¾ç¤ºæ­£å¸¸

---

### Sprint 4: è§’è‰²å…¥å£ä¸åæ§½å¡é¡µé¢

**ç›®æ ‡**: å®ç°è§’è‰²å…¥å£å’Œåæ§½å¡åˆ†äº«é¡µé¢

**æ—¶é—´**: 4-5 å¤©

**çŠ¶æ€**: â³ å¾…å¼€å§‹

**ä¾èµ–**: Sprint 3 å®Œæˆåå¼€å§‹

#### ä»»åŠ¡æ¸…å•

**4.1 è§’è‰²å…¥å£é¡µé¢ (Roles.vue)**

*4.1.1 è§’è‰²æ•°æ®ç®¡ç†*
- [ ] å®šä¹‰è§’è‰²æ•°æ®ç»“æ„ (åŸºäº mock-data.js)
- [ ] åç«¯æ·»åŠ  `/api/roles` æ¥å£ (å¯é€‰,æˆ–ä½¿ç”¨å‰ç«¯é™æ€æ•°æ®)
- [ ] å®ç°è§’è‰²æ•°æ®åŠ è½½å’Œç¼“å­˜

*4.1.2 è§’è‰²å¡ç‰‡ç»„ä»¶*
- [ ] åˆ›å»º `RoleCard.vue` ç»„ä»¶
- [ ] æ¸å˜å¤´åƒ (FontAwesome Icon + æ¸å˜èƒŒæ™¯)
- [ ] ç­‰çº§å¾½æ ‡æ˜¾ç¤º (ğŸ”¥ æœ€çƒ­, âœ¨ æ–°å¢)
- [ ] è§’è‰²æè¿°å’Œå¼•ç”¨åæ§½
- [ ] "è¿›å…¥æ€’æ°”ç°åœº" CTA æŒ‰é’®

*4.1.3 é¡µé¢å¸ƒå±€ä¸äº¤äº’*
- [ ] å¡ç‰‡æ …æ ¼å¸ƒå±€ (æ¡Œé¢3åˆ—,ç§»åŠ¨1åˆ—)
- [ ] è§’è‰²æ€»æ•°ç»Ÿè®¡æ˜¾ç¤º
- [ ] è§’è‰²ç­›é€‰åŠŸèƒ½ (å¯é€‰)
- [ ] æœç´¢åŠŸèƒ½ (å¯é€‰)
- [ ] ç‚¹å‡»å¡ç‰‡è·³è½¬åˆ°é¦–é¡µå¹¶æºå¸¦è§’è‰²å‚æ•° (`?role=key`)

*4.1.4 æ ·å¼ä¼˜åŒ–*
- [ ] æŒ‰é’®é«˜å¯¹æ¯”åº¦æ¸å˜
- [ ] å¡ç‰‡ Hover æ•ˆæœ
- [ ] å“åº”å¼é€‚é…

**4.2 åæ§½å¡é¡µé¢ (Share.vue)**

*4.2.1 å¡ç‰‡æ¨¡æ¿ç¼–è¾‘å™¨*
- [ ] åˆ›å»º `TemplateEditor.vue` ç»„ä»¶
- [ ] æ–‡æœ¬è¾“å…¥æ¡† (åæ§½å†…å®¹)
- [ ] è§’è‰²é€‰æ‹©å™¨
- [ ] èƒŒæ™¯é¢œè‰²/æ ·å¼é€‰æ‹©
- [ ] å®æ—¶é¢„è§ˆè”åŠ¨

*4.2.2 å¡ç‰‡é¢„è§ˆç»„ä»¶*
- [ ] åˆ›å»º `CardPreview.vue` ç»„ä»¶
- [ ] æ˜¾ç¤ºç¼–è¾‘åçš„å¡ç‰‡æ•ˆæœ
- [ ] æ”¯æŒå¤šç§æ¨¡æ¿æ ·å¼
- [ ] å¯¹æ¥ `/api/phrases/:page` æ¥å£è·å–æ¨èæ–‡æ¡ˆ

*4.2.3 å›¾ç‰‡ç”Ÿæˆä¸ä¸‹è½½*
- [ ] å®‰è£… `html2canvas` æˆ– `dom-to-image`
- [ ] å®ç°å¡ç‰‡å¯¼å‡ºä¸ºå›¾ç‰‡åŠŸèƒ½
- [ ] æ·»åŠ ä¸‹è½½æŒ‰é’®
- [ ] æ·»åŠ æ°´å° (nowork.click)

*4.2.4 ç¤¾äº¤åˆ†äº«åŠŸèƒ½*
- [ ] ç”Ÿæˆåˆ†äº«é“¾æ¥ (å¸¦ UTM å‚æ•°)
- [ ] å¤åˆ¶é“¾æ¥åˆ°å‰ªè´´æ¿
- [ ] é¢„è®¾åˆ†äº«æ–‡æ¡ˆ
- [ ] åˆ†äº«åˆ°å¾®ä¿¡/å¾®åš/Twitter (å¯é€‰)

*4.2.5 æ¨¡æ¿åˆ—è¡¨*
- [ ] æ˜¾ç¤ºå†å²ç”Ÿæˆçš„å¡ç‰‡
- [ ] æ¨¡æ¿ç­›é€‰åŠŸèƒ½
- [ ] å¿«é€Ÿåº”ç”¨æ¨¡æ¿

#### éªŒæ”¶æ ‡å‡†
- âœ… è§’è‰²å¡ç‰‡æ­£ç¡®æ˜¾ç¤ºä¸”å¯ç‚¹å‡»è·³è½¬
- âœ… è§’è‰²å‚æ•°æ­£ç¡®ä¼ é€’åˆ°é¦–é¡µ
- âœ… åæ§½å¡ç¼–è¾‘å™¨åŠŸèƒ½æ­£å¸¸
- âœ… å›¾ç‰‡ç”Ÿæˆå’Œä¸‹è½½åŠŸèƒ½æ­£å¸¸
- âœ… åˆ†äº«é“¾æ¥å¯æ­£ç¡®å¤åˆ¶

---

### Sprint 5: ä½“éªŒä¼˜åŒ–ä¸é«˜çº§åŠŸèƒ½

**ç›®æ ‡**: ä¼˜åŒ–ç”¨æˆ·ä½“éªŒ,å®Œå–„åŠ¨ç”»ã€éŸ³æ•ˆã€å“åº”å¼è®¾è®¡

**æ—¶é—´**: 3-4 å¤©

**çŠ¶æ€**: â³ å¾…å¼€å§‹

**ä¾èµ–**: Sprint 4 å®Œæˆåå¼€å§‹

#### ä»»åŠ¡æ¸…å•

**5.1 éŸ³æ•ˆç³»ç»Ÿå®Œå–„**
- [ ] å‡†å¤‡ä¸åŒæ€’æ°”ç­‰çº§çš„éŸ³æ•ˆæ–‡ä»¶ (5æ¡£)
- [ ] åˆ›å»º `composables/useSound.ts`
- [ ] å®ç°éŸ³æ•ˆé¢„åŠ è½½
- [ ] æ·»åŠ éŸ³æ•ˆå¼€å…³ (ç”¨æˆ·å¯æ§)
- [ ] éŸ³æ•ˆéŸ³é‡æ§åˆ¶

**5.2 åŠ¨ç”»ç³»ç»Ÿä¼˜åŒ–**
- [ ] æ€’æ°”æŒ‰é’®æ¸å˜åŠ¨ç”»ä¼˜åŒ–
- [ ] ç²’å­æ•ˆæœ (ç‚¹å‡»æ—¶çˆ†å‘ç²’å­)
- [ ] é¡µé¢åˆ‡æ¢è¿‡æ¸¡åŠ¨ç”»
- [ ] æ¦œå•æ•°æ®æ›´æ–°åŠ¨ç”»
- [ ] éª¨æ¶å±åŠ è½½åŠ¨ç”»

**5.3 å“åº”å¼è®¾è®¡å®Œå–„**
- [ ] ç§»åŠ¨ç«¯é€‚é… (375px - 768px)
- [ ] å¹³æ¿é€‚é… (768px - 1024px)
- [ ] æ¡Œé¢ç«¯é€‚é… (1024px+)
- [ ] è§¦æ‘¸ä¼˜åŒ– (ç§»åŠ¨ç«¯æ‰‹åŠ¿)
- [ ] å­—ä½“å¤§å°è‡ªé€‚åº”

**5.4 æ€§èƒ½ä¼˜åŒ–**
- [ ] ç»„ä»¶æ‡’åŠ è½½å’Œä»£ç åˆ†å‰²
- [ ] å›¾ç‰‡æ‡’åŠ è½½å’Œä¼˜åŒ–
- [ ] ECharts æŒ‰éœ€å¼•å…¥
- [ ] è™šæ‹Ÿæ»šåŠ¨ (é•¿åˆ—è¡¨)
- [ ] é˜²æŠ–èŠ‚æµä¼˜åŒ–

**5.5 é”™è¯¯å¤„ç†ä¸ç”¨æˆ·åé¦ˆ**
- [ ] å…¨å±€é”™è¯¯æ‹¦æˆªå™¨
- [ ] Toast æç¤ºç»„ä»¶
- [ ] ç½‘ç»œé”™è¯¯å‹å¥½æç¤º
- [ ] åŠ è½½çŠ¶æ€æŒ‡ç¤º
- [ ] ç©ºçŠ¶æ€è®¾è®¡

**5.6 SEO ä¸å¯è®¿é—®æ€§**
- [ ] Meta æ ‡ç­¾ä¼˜åŒ– (title, description, og:image)
- [ ] è¯­ä¹‰åŒ– HTML
- [ ] ARIA æ ‡ç­¾æ·»åŠ 
- [ ] Lighthouse æ€§èƒ½æµ‹è¯• (ç›®æ ‡ 90+)
- [ ] SSR/SSG è¯„ä¼° (å¯é€‰)

#### éªŒæ”¶æ ‡å‡†
- âœ… ç§»åŠ¨ç«¯ä½“éªŒæµç•…
- âœ… éŸ³æ•ˆç³»ç»Ÿå®Œå–„ä¸”å¯æ§
- âœ… é¡µé¢åŠ è½½æ€§èƒ½ä¼˜å¼‚ (Lighthouse 90+)
- âœ… é”™è¯¯å¤„ç†å‹å¥½
- âœ… å¯è®¿é—®æ€§è¾¾æ ‡

---

### Sprint 6: åç«¯å¢å¼ºä¸æ•°æ®ç®¡ç†

**ç›®æ ‡**: å®Œå–„åç«¯åŠŸèƒ½,æ·»åŠ ç®¡ç†æ¥å£å’Œæ•°æ®å¯¼å‡º

**æ—¶é—´**: 3-4 å¤©

**çŠ¶æ€**: â³ å¾…å¼€å§‹

**ä¾èµ–**: Sprint 1-5 å¹¶è¡Œæˆ–å®Œæˆåå¼€å§‹

#### ä»»åŠ¡æ¸…å•

**6.1 IP å®šä½å¢å¼º**
- [ ] å®ç° ip-api.com å›é€€æœºåˆ¶
- [ ] æ·»åŠ å¤šä¸ª IP å®šä½æœåŠ¡æä¾›å•†
- [ ] å®ç°æ™ºèƒ½é™çº§ç­–ç•¥
- [ ] IP å®šä½å‡†ç¡®ç‡ç»Ÿè®¡

**6.2 è§’è‰²æ•°æ®ç®¡ç†æ¥å£**
- [ ] è®¾è®¡è§’è‰²æ•°æ®è¡¨ç»“æ„
- [ ] å®ç° `/api/roles` GET æ¥å£
- [ ] å®ç° `/api/roles/:id` CRUD æ¥å£
- [ ] è§’è‰²æ•°æ®å¯¼å…¥å¯¼å‡º

**6.3 æ•°æ®å¯¼å‡ºåŠŸèƒ½**
- [ ] å®ç° CSV å¯¼å‡º (`/api/export/stats`)
- [ ] å®ç° Excel å¯¼å‡º (ä½¿ç”¨ exceljs)
- [ ] æ”¯æŒæ—¥æœŸèŒƒå›´ç­›é€‰
- [ ] æ”¯æŒåˆ†é¡µå¯¼å‡º (å¤§æ•°æ®é‡)

**6.4 ç®¡ç†åå° API (å¯é€‰)**
- [ ] è®¤è¯ä¸æˆæƒ (JWT)
- [ ] ç»Ÿè®¡æ•°æ®æ€»è§ˆæ¥å£
- [ ] ç”¨æˆ·è¡Œä¸ºåˆ†ææ¥å£
- [ ] ç³»ç»Ÿå¥åº·æ£€æŸ¥æ¥å£

**6.5 WebSocket å®æ—¶æ¨é€ (å¯é€‰)**
- [ ] é›†æˆ Socket.IO
- [ ] å®æ—¶æ¨é€ç‚¹å‡»äº‹ä»¶
- [ ] å®æ—¶æ›´æ–°æ’è¡Œæ¦œ
- [ ] æˆ¿é—´ç®¡ç†å’Œå¹¿æ’­

**6.6 æ—¥å¿—ä¸ç›‘æ§**
- [ ] ç»“æ„åŒ–æ—¥å¿—è¾“å‡º
- [ ] æ…¢æŸ¥è¯¢æ—¥å¿—
- [ ] API æ€§èƒ½ç›‘æ§
- [ ] é”™è¯¯å‘Šè­¦æœºåˆ¶

#### éªŒæ”¶æ ‡å‡†
- âœ… IP å®šä½å›é€€æœºåˆ¶æ­£å¸¸å·¥ä½œ
- âœ… æ•°æ®å¯¼å‡ºåŠŸèƒ½æ­£å¸¸
- âœ… ç®¡ç†æ¥å£å¯ç”¨ (å¦‚æœå®ç°)
- âœ… æ—¥å¿—å®Œæ•´ä¸”å¯è¿½æº¯

---

### Sprint 7: æµ‹è¯•ã€éƒ¨ç½²ä¸ä¸Šçº¿

**ç›®æ ‡**: å…¨é¢æµ‹è¯•,ç”Ÿäº§éƒ¨ç½²,ä¸Šçº¿å‘å¸ƒ

**æ—¶é—´**: 4-5 å¤©

**çŠ¶æ€**: â³ å¾…å¼€å§‹

**ä¾èµ–**: Sprint 1-6 å…¨éƒ¨å®Œæˆ

#### ä»»åŠ¡æ¸…å•

**7.1 åç«¯æµ‹è¯•**
- [ ] ç¼–å†™å•å…ƒæµ‹è¯• (Vitest)
  - [ ] æœåŠ¡å±‚æµ‹è¯• (IP å®šä½ã€ç»Ÿè®¡èšåˆ)
  - [ ] Redis æ“ä½œæµ‹è¯•
  - [ ] Worker æµ‹è¯•
- [ ] ç¼–å†™é›†æˆæµ‹è¯•
  - [ ] API ï¿½ï¿½å£æµ‹è¯•
  - [ ] æ•°æ®åº“æ“ä½œæµ‹è¯•
  - [ ] Redis é›†æˆæµ‹è¯•
- [ ] æµ‹è¯•è¦†ç›–ç‡ > 70%

**7.2 å‰ç«¯æµ‹è¯•**
- [ ] ç»„ä»¶å•å…ƒæµ‹è¯• (Vitest + Testing Library)
  - [ ] æŒ‰é’®ç»„ä»¶æµ‹è¯•
  - [ ] å¡ç‰‡ç»„ä»¶æµ‹è¯•
  - [ ] æ¦œå•ç»„ä»¶æµ‹è¯•
- [ ] E2E æµ‹è¯• (Playwright)
  - [ ] é¦–é¡µäº¤äº’æµ‹è¯•
  - [ ] æ¦œå•é¡µé¢æµ‹è¯•
  - [ ] åæ§½å¡ç”Ÿæˆæµ‹è¯•
- [ ] æµ‹è¯•è¦†ç›–æ ¸å¿ƒåŠŸèƒ½

**7.3 æ€§èƒ½æµ‹è¯•**
- [ ] åç«¯å‹åŠ›æµ‹è¯• (Apache Bench / k6)
  - [ ] `/api/hit` æ¥å£ (ç›®æ ‡ 100+ QPS)
  - [ ] `/api/stats` æ¥å£
- [ ] å‰ç«¯æ€§èƒ½æµ‹è¯• (Lighthouse)
  - [ ] æ€§èƒ½åˆ†æ•° > 90
  - [ ] å¯è®¿é—®æ€§åˆ†æ•° > 90
- [ ] æ•°æ®åº“æŸ¥è¯¢ä¼˜åŒ–
- [ ] Redis ç¼“å­˜å‘½ä¸­ç‡åˆ†æ

**7.4 ç”Ÿäº§ç¯å¢ƒé…ç½®**
- [ ] é…ç½®ç”Ÿäº§ç¯å¢ƒå˜é‡ (`.env.prod`)
- [ ] Docker ç”Ÿäº§é•œåƒä¼˜åŒ–
  - [ ] å¤šé˜¶æ®µæ„å»º
  - [ ] é•œåƒä½“ç§¯ä¼˜åŒ–
  - [ ] å¥åº·æ£€æŸ¥é…ç½®
- [ ] Nginx åå‘ä»£ç†é…ç½®
  - [ ] HTTPS è¯ä¹¦é…ç½®
  - [ ] Gzip å‹ç¼©
  - [ ] é™æ€èµ„æºç¼“å­˜
- [ ] æ•°æ®åº“å¤‡ä»½ç­–ç•¥
- [ ] Redis æŒä¹…åŒ–é…ç½®

**7.5 CI/CD æµç¨‹**
- [ ] é…ç½® GitHub Actions
  - [ ] è‡ªåŠ¨æµ‹è¯•æµç¨‹
  - [ ] è‡ªåŠ¨æ„å»ºæµç¨‹
  - [ ] è‡ªåŠ¨éƒ¨ç½²æµç¨‹
- [ ] å‰ç«¯éƒ¨ç½²åˆ° Cloudflare Pages
- [ ] åç«¯éƒ¨ç½²åˆ°æœåŠ¡å™¨ (Docker Compose)
- [ ] æ•°æ®åº“è¿ç§»è„šæœ¬

**7.6 ç›‘æ§ä¸å‘Šè­¦**
- [ ] æ¥å…¥ Cloudflare Analytics
- [ ] é…ç½® Prometheus + Grafana (å¯é€‰)
  - [ ] QPS ç›‘æ§
  - [ ] Redis ç›‘æ§
  - [ ] MySQL ç›‘æ§
  - [ ] API å“åº”æ—¶é—´
- [ ] æ—¥å¿—èšåˆ (Loki)
- [ ] å‘Šè­¦è§„åˆ™é…ç½®
  - [ ] API é”™è¯¯ç‡å‘Šè­¦
  - [ ] Redis é˜Ÿåˆ—ç§¯å‹å‘Šè­¦
  - [ ] æ•°æ®åº“è¿æ¥æ•°å‘Šè­¦

**7.7 æ–‡æ¡£ä¸å‘å¸ƒ**
- [ ] æ›´æ–° README.md
- [ ] ç¼–å†™éƒ¨ç½²æ–‡æ¡£
- [ ] ç¼–å†™è¿ç»´æ‰‹å†Œ
- [ ] ç¼–å†™ API æ–‡æ¡£
- [ ] å‘å¸ƒ v1.0.0 ç‰ˆæœ¬

#### éªŒæ”¶æ ‡å‡†
- âœ… æ‰€æœ‰æµ‹è¯•é€šè¿‡,è¦†ç›–ç‡è¾¾æ ‡
- âœ… æ€§èƒ½æŒ‡æ ‡è¾¾æ ‡ (QPSã€å“åº”æ—¶é—´ã€Lighthouse)
- âœ… ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²æˆåŠŸ
- âœ… ç›‘æ§å’Œå‘Šè­¦ç³»ç»Ÿæ­£å¸¸è¿è¡Œ
- âœ… æ–‡æ¡£é½å…¨

## å¾…å¼€å‘åŠŸèƒ½ä¼˜å…ˆçº§

### P0 (å¿…é¡»å®Œæˆ)
- Redis é›†æˆå’Œ Worker è½åº“æœºåˆ¶
- Vue 3 å‰ç«¯åˆå§‹åŒ–å’Œæ ¸å¿ƒé¡µé¢
- ECharts åœ°å›¾é›†æˆ
- åŸºç¡€éŸ³æ•ˆç³»ç»Ÿ

### P1 (é‡è¦åŠŸèƒ½)
- åæ§½å¡ç”Ÿæˆå’Œåˆ†äº«
- å“åº”å¼ä¼˜åŒ–
- ip-api.com å›é€€æœºåˆ¶
- åŸºç¡€ç›‘æ§

### P2 (ä¼˜åŒ–é¡¹)
- å•å…ƒæµ‹è¯•å’Œé›†æˆæµ‹è¯•
- ç®¡ç†åå°
- WebSocket å®æ—¶æ¨é€
- é«˜çº§åŠ¨ç”»æ•ˆæœ

## å‚è€ƒæ–‡æ¡£

- [é¡¹ç›®å¼€å‘è®¡åˆ’](docs/development-plan.md) - å®Œæ•´æŠ€æœ¯æ–¹æ¡ˆå’ŒåŠŸèƒ½è®¾è®¡
- [åŸå‹è®¾è®¡æ–‡æ¡£](prototype/README.md) - UI/UX è®¾è®¡è¯´æ˜
- [Fastify å®˜æ–¹æ–‡æ¡£](https://fastify.dev/)
- [ip2region æ–‡æ¡£](https://github.com/lionsoul2014/ip2region)

---

## å¿«é€Ÿå¼€å§‹æ–° Sprint æ£€æŸ¥æ¸…å•

### å¼€å§‹ Sprint å‰

- [ ] ç¡®è®¤ä¸Šä¸€ä¸ª Sprint çš„éªŒæ”¶æ ‡å‡†å…¨éƒ¨è¾¾æ ‡
- [ ] æ›´æ–° Git åˆ†æ”¯ (`git checkout -b sprint-N/feature-name`)
- [ ] æ£€æŸ¥ä¾èµ–é¡¹æ˜¯å¦éœ€è¦æ›´æ–° (`pnpm outdated`)
- [ ] åŒæ­¥ Docker ç¯å¢ƒ (`docker compose -f docker/docker-compose.dev.yml pull`)

### Sprint è¿›è¡Œä¸­

- [ ] æ¯æ—¥æäº¤ä»£ç å¹¶æ¨é€åˆ°è¿œç¨‹ä»“åº“
- [ ] æ›´æ–° CLAUDE.md ä¸­å¯¹åº” Sprint çš„ä»»åŠ¡æ¸…å• (âœ…/ğŸ”„/âŒ)
- [ ] é‡åˆ°é˜»å¡é—®é¢˜æ—¶è®°å½•åˆ° `docs/blockers.md` (å¯é€‰)
- [ ] å®šæœŸè¿è¡Œæµ‹è¯•ç¡®ä¿åŠŸèƒ½æ­£å¸¸

### Sprint ç»“æŸæ—¶

- [ ] è¿è¡Œå®Œæ•´æµ‹è¯•å¥—ä»¶ (`pnpm run test`)
- [ ] æ£€æŸ¥éªŒæ”¶æ ‡å‡†æ˜¯å¦å…¨éƒ¨é€šè¿‡
- [ ] åˆå¹¶ä»£ç åˆ° main åˆ†æ”¯
- [ ] æ›´æ–° Sprint çŠ¶æ€ä¸º âœ… å·²å®Œæˆ
- [ ] åœ¨ Git ä¸Šæ‰“ Tag (`git tag sprint-N-complete`)

---

## å¸¸è§é—®é¢˜æ’æŸ¥

### åç«¯é—®é¢˜

**Redis è¿æ¥å¤±è´¥**
```bash
# æ£€æŸ¥ Redis å®¹å™¨çŠ¶æ€
docker ps | grep redis
docker logs nowork-redis-dev

# æ‰‹åŠ¨è¿æ¥æµ‹è¯•
docker exec -it nowork-redis-dev redis-cli ping
```

**MySQL è¿æ¥å¤±è´¥**
```bash
# æ£€æŸ¥ MySQL å¥åº·çŠ¶æ€
docker inspect nowork-mysql-dev | grep Health

# æŸ¥çœ‹é”™è¯¯æ—¥å¿—
docker logs nowork-mysql-dev
```

**TypeScript ç¼–è¯‘é”™è¯¯**
```bash
# æ¸…ç†ç¼“å­˜é‡æ–°ç¼–è¯‘
rm -rf dist/
pnpm run build
```

### å‰ç«¯é—®é¢˜

**ä¾èµ–å®‰è£…å¤±è´¥**
```bash
# æ¸…ç† pnpm ç¼“å­˜
pnpm store prune
rm -rf node_modules pnpm-lock.yaml
pnpm install
```

**ç«¯å£è¢«å ç”¨**
```bash
# Windows æŸ¥æ‰¾å ç”¨ 3000 ç«¯å£çš„è¿›ç¨‹
netstat -ano | findstr :3000
taskkill /PID <PID> /F

# Linux/Mac
lsof -ti:3000 | xargs kill -9
```

### Docker é—®é¢˜

**å®¹å™¨å¯åŠ¨å¤±è´¥**
```bash
# æŸ¥çœ‹è¯¦ç»†æ—¥å¿—
docker compose -f docker/docker-compose.dev.yml logs --tail=100

# é‡å»ºå®¹å™¨
docker compose -f docker/docker-compose.dev.yml down -v
docker compose -f docker/docker-compose.dev.yml up -d --build
```

**ç£ç›˜ç©ºé—´ä¸è¶³**
```bash
# æ¸…ç†æœªä½¿ç”¨çš„ Docker èµ„æº
docker system prune -a --volumes
```